# Project Domains
#
# Shared definition of all project domains for setup skills.
# Skills can load this file to get the canonical list of domains.
#
# Usage in skills:
#   Reference: plugins/crunch/data/domains.yaml
#   Load domains list and filter by required/optional as needed.
#
# vendor_requirements: List of capabilities a vendor must support for this domain.
# Used by lookup-vendor to evaluate vendor fit and by setup skills to verify configuration.

domains:
  # Required domains (core project infrastructure)
  - name: Tech Stack
    key: tech-stack
    purpose: Auto-detect and configure project stack
    required: true
    has_vendor: false

  - name: Configuration
    key: configuration
    purpose: Manage env variables per environment
    required: true
    has_vendor: true
    vendor_requirements: []

  - name: Secrets
    key: secrets
    purpose: Store and retrieve secrets securely
    required: true
    has_vendor: true
    vendor_requirements:
      - It should allow to create a new secret
      - It should allow to read a secret value
      - It should allow to update an existing secret
      - It should allow to delete a secret
      - It should allow to list available secrets
      - It should allow to check whether a secret exists
    vendors:
      - name: HashiCorp Vault
        key: vault
        description: Enterprise secrets management with dynamic secrets and encryption
        integration:
          - type: cli
            tool: vault
            install: "brew install vault"
          - type: api
            docs: "https://developer.hashicorp.com/vault/api-docs"
          - type: mcp
            package: "@anthropic/mcp-vault"
        best_for: "Enterprise, dynamic secrets, multi-cloud"
        satisfies_all: true

      - name: AWS Secrets Manager
        key: aws-secrets-manager
        description: AWS-native secrets management with rotation support
        integration:
          - type: cli
            tool: aws
            install: "brew install awscli"
            prefix: "aws secretsmanager"
          - type: api
            docs: "https://docs.aws.amazon.com/secretsmanager/latest/apireference/"
        best_for: "AWS-native workloads"
        satisfies_all: true

      - name: Google Secret Manager
        key: gcp-secret-manager
        description: GCP-native secrets management
        integration:
          - type: cli
            tool: gcloud
            install: "brew install google-cloud-sdk"
            prefix: "gcloud secrets"
          - type: api
            docs: "https://cloud.google.com/secret-manager/docs/reference/rest"
        best_for: "GCP-native workloads"
        satisfies_all: true

      - name: Azure Key Vault
        key: azure-key-vault
        description: Azure-native secrets, keys, and certificates management
        integration:
          - type: cli
            tool: az
            install: "brew install azure-cli"
            prefix: "az keyvault secret"
          - type: api
            docs: "https://learn.microsoft.com/en-us/rest/api/keyvault/"
        best_for: "Azure-native workloads"
        satisfies_all: true

      - name: Doppler
        key: doppler
        description: Universal secrets manager with sync to multiple platforms
        integration:
          - type: cli
            tool: doppler
            install: "brew install dopplerhq/cli/doppler"
          - type: api
            docs: "https://docs.doppler.com/reference/api"
          - type: mcp
            package: "@doppler/mcp-server"
        best_for: "Multi-environment, team collaboration"
        satisfies_all: true

      - name: 1Password
        key: 1password
        description: Password manager with secrets automation and CLI
        integration:
          - type: cli
            tool: op
            install: "brew install 1password-cli"
          - type: api
            docs: "https://developer.1password.com/docs/connect/connect-api-reference/"
          - type: mcp
            package: "@1password/mcp-server"
        best_for: "Teams already using 1Password, developer secrets"
        satisfies_all: true

      - name: Infisical
        key: infisical
        description: Open-source secrets management with E2E encryption
        integration:
          - type: cli
            tool: infisical
            install: "brew install infisical/get-cli/infisical"
          - type: api
            docs: "https://infisical.com/docs/api-reference/overview"
        best_for: "Open-source, self-hosted, E2E encryption"
        satisfies_all: true

      - name: SOPS
        key: sops
        description: File-based secrets with encryption (age, GPG, cloud KMS)
        integration:
          - type: cli
            tool: sops
            install: "brew install sops"
        best_for: "GitOps, file-based config, no external service"
        satisfies_all: true
        notes: "Requires age or GPG for key management"

      - name: Bitwarden Secrets Manager
        key: bitwarden-sm
        description: Secrets management from Bitwarden with CLI and SDK
        integration:
          - type: cli
            tool: bws
            install: "brew install bitwarden/tap/bws"
          - type: api
            docs: "https://bitwarden.com/help/secrets-manager-api/"
        best_for: "Teams using Bitwarden, open-source friendly"
        satisfies_all: true

  - name: Pipelines
    key: pipelines
    purpose: Define project pipelines (local, CI, deploy)
    required: true
    has_vendor: false

  - name: Deploy Environments
    key: deploy-environments
    purpose: Manage dev/staging/prod environments
    required: true
    has_vendor: false

  - name: Task Management
    key: task-management
    purpose: Track and manage work items
    required: true
    has_vendor: true
    vendor_requirements:
      # 1. Core operations (all task types ∈ {Input, Intent, Issue, WorkItem})
      - It should allow to create a task ∈ {Input, Intent, Issue, WorkItem}
      - It should allow to read a task by id
      - It should allow to update task fields
      - It should allow to delete / cancel a task (where allowed by type)
      - It should allow to list tasks filtered by {type, status, relations}
      - It should allow to check existence of a task
      - It should allow to change task status, enforcing valid transitions
      # 2. Input operations
      - It should allow to create Input
      - It should allow to transition Input status ∈ {New → Reviewed → Dropped}
      - It should allow to classify Input → {Intent, Issue}, creating the target task
      # 3. Intent operations
      - It should allow to create Intent (optionally derived from Input)
      - It should allow to update Intent definition ∈ {outcome, value, success criteria}
      - It should allow to transition Intent status ∈ {Draft → Refined → Approved → Completed}
      - It should allow to decompose Intent → {WorkItem}*
      - It should allow to query WorkItems implementing Intent
      - It should allow to complete Intent when completion condition is met
      # 4. Issue operations
      - It should allow to create Issue (optionally derived from Input)
      - It should allow to update Issue definition ∈ {expected, actual, severity}
      - It should allow to transition Issue status ∈ {Reported → Confirmed → Planned → Resolved → Verified, WontFix}
      - It should allow to create WorkItem fixing Issue
      - It should allow to query WorkItems fixing Issue
      - It should allow to resolve Issue when fix WorkItem is Done
      - It should allow to verify Issue
      # 5. WorkItem operations
      - It should allow to create WorkItem (from {Intent, Issue})
      - It should allow to update WorkItem definition ∈ {scope, exclusions, acceptance criteria, DoD}
      - It should allow to transition WorkItem status ∈ {Backlog ↔ InProgress ↔ Blocked ↔ Done}
      - It should allow to assign / reassign WorkItem
      - It should allow to link WorkItem → Intent (implements)
      - It should allow to link WorkItem → Issue (fixes)
      - It should allow to block WorkItem, creating Blocker WorkItem
      - It should allow to unblock WorkItem when Blocker is Done
      # 6. Relationship & traceability operations
      - It should allow to create relations ∈ {derived-from, implements, fixes, blocks}
      - "It should allow to query relations: Input → {Intent, Issue}"
      - "It should allow to query relations: Intent → {WorkItem}"
      - "It should allow to query relations: Issue → {WorkItem}"
      - "It should allow to query relations: WorkItem → {Intent, Issue, WorkItem(blocks)}"
      # 7. Validation & invariants
      - It should allow to validate state transition for any task
      - It should allow to validate WorkItem readiness (DoD present)
      - It should allow to check Intent completion (all WorkItems Done)
      - It should allow to check Issue resolution (fix WorkItems Done)
      - "It should validate invariant: WorkItem:InProgress ⇒ {Intent:Approved ∨ Issue:Planned}"
      - "It should validate invariant: WorkItem:Blocked ⇒ ∃ Blocker WorkItem"
      - "It should validate invariant: Issue:Resolved ⇒ ∃ Done WorkItem fixing it"

  - name: Agents & Orchestration
    key: agents-and-orchestration
    purpose: Configure Claude Code agents
    required: true
    has_vendor: false

  # Optional domains (extended capabilities)
  - name: Memory Management
    key: memory-management
    purpose: Persistent AI context across sessions
    required: false
    has_vendor: true
    vendor_requirements: []

  - name: User Communication Bot
    key: user-communication-bot
    purpose: Slack app/bot for project development
    required: false
    has_vendor: true
    vendor_requirements: []

  - name: CI/CD
    key: ci-cd
    purpose: Continuous integration/deployment
    required: false
    has_vendor: true
    vendor_requirements: []

  - name: Observability
    key: observability
    purpose: Metrics, logs, traces, alerting
    required: false
    has_vendor: true
    vendor_requirements: []

  - name: Problem Remediation
    key: problem-remediation
    purpose: Runbook automation, self-healing
    required: false
    has_vendor: true
    vendor_requirements: []

  - name: Documentation
    key: documentation
    purpose: Doc site generation and publishing
    required: false
    has_vendor: true
    vendor_requirements: []

  - name: Localization
    key: localization
    purpose: Internationalization and translation
    required: false
    has_vendor: true
    vendor_requirements: []
